主要追踪算法实现